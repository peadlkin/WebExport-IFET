<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Report a Bug - IFET</title>
  <link rel="stylesheet" href="../common.css">
</head>
<body>
  <div class="container">
    <div class="panel" id="bugForm">
      <h1 class="page-title" data-i18n="title">Report a Bug üêõ</h1>
      <p class="page-subtitle" data-i18n="subtitle">Help us fix issues by describing what went wrong</p>
      
      <form onsubmit="submitBugReport(event)">
        <div class="form-group">
          <label for="profileUrl" data-i18n="profileLabel">Instagram profile URL where the bug occurred</label>
          <input 
            type="text" 
            id="profileUrl" 
            placeholder="" 
            data-i18n="profilePlaceholder"
            required
          >
          <span class="hint" data-i18n="profileHint">Example: https://instagram.com/username or @username</span>
        </div>
        
        <div class="form-group">
          <label for="description" data-i18n="descriptionLabel">What happened? *</label>
          <textarea 
            id="description" 
            placeholder="" 
            data-i18n="descriptionPlaceholder"
            required
          ></textarea>
          <span class="hint" data-i18n="descriptionHint">Please describe the problem in detail</span>
        </div>
        
        <div class="form-group">
          <label for="email" data-i18n="emailLabel">Your email (optional)</label>
          <input 
            type="email" 
            id="email" 
            placeholder="" 
            data-i18n="emailPlaceholder"
          >
          <span class="hint" data-i18n="emailHint">We'll contact you if we need more information</span>
        </div>
        
        <div class="button-group">
          <button type="button" class="btn btn-secondary" onclick="window.close()" data-i18n="btnCancel">Cancel</button>
          <button type="submit" class="btn btn-primary" data-i18n="btnSend">Send Report</button>
        </div>
      </form>
    </div>
    
    <div class="panel" id="successMessage" style="display: none;">
      <div class="success-message">
        <h1 data-i18n="successTitle">Thank you! üôè</h1>
        <p data-i18n="successText">We'll investigate this issue and work on a fix!</p>
      </div>
    </div>
  </div>
  
  <script src="../lang.js"></script>
  <script>
    // Translations
    const translations = {
      en: {
        title: 'Report a Bug üêõ',
        subtitle: 'Help us fix issues by describing what went wrong',
        profileLabel: 'Instagram profile URL where the bug occurred',
        profilePlaceholder: 'https://instagram.com/username or @username',
        profileHint: 'Example: https://instagram.com/username or @username',
        descriptionLabel: 'What happened? *',
        descriptionPlaceholder: 'Describe the problem...',
        descriptionHint: 'Please describe the problem in detail',
        emailLabel: 'Your email (optional)',
        emailPlaceholder: 'your@email.com',
        emailHint: "We'll contact you if we need more information",
        btnCancel: 'Cancel',
        btnSend: 'Send Report',
        successTitle: 'Thank you! üôè',
        successText: "We'll investigate this issue and work on a fix!"
      },
      ru: {
        title: '–°–æ–æ–±—â–∏—Ç—å –æ–± –æ—à–∏–±–∫–µ üêõ',
        subtitle: '–ü–æ–º–æ–≥–∏—Ç–µ –Ω–∞–º –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã, –æ–ø–∏—Å–∞–≤ —á—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫',
        profileLabel: 'URL –ø—Ä–æ—Ñ–∏–ª—è Instagram, –≥–¥–µ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞',
        profilePlaceholder: 'https://instagram.com/username –∏–ª–∏ @username',
        profileHint: '–ù–∞–ø—Ä–∏–º–µ—Ä: https://instagram.com/username –∏–ª–∏ @username',
        descriptionLabel: '–ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ? *',
        descriptionPlaceholder: '–û–ø–∏—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É...',
        descriptionHint: '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–ø–∏—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É –ø–æ–¥—Ä–æ–±–Ω–æ',
        emailLabel: '–í–∞—à email (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)',
        emailPlaceholder: 'your@email.com',
        emailHint: '–ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏, –µ—Å–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –±–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏',
        btnCancel: '–û—Ç–º–µ–Ω–∞',
        btnSend: '–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç—á—ë—Ç',
        successTitle: '–°–ø–∞—Å–∏–±–æ! üôè',
        successText: '–ú—ã –∏–∑—É—á–∏–º —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É –∏ –ø–æ—Ä–∞–±–æ—Ç–∞–µ–º –Ω–∞–¥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º!'
      }
    };
    
    // Wait for lang.js to load and DOM to be ready
    function initTranslations() {
      if (window.IFET && window.IFET.initTranslations) {
        window.IFET.initTranslations(translations);
      } else {
        setTimeout(initTranslations, 50);
      }
    }
    
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initTranslations);
    } else {
      initTranslations();
    }
    
    // Submit bug report
    async function submitBugReport(event) {
      event.preventDefault();
      
      const profileUrl = document.getElementById('profileUrl').value;
      const description = document.getElementById('description').value;
      const email = document.getElementById('email').value;
      
      try {
        // Send bug report to server
        const response = await fetch('https://webexport.pro/api/ifet/feedback', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            type: 'bug',
            lang: window.IFET.currentLang,
            profileUrl: profileUrl,
            description: description,
            email: email,
            userAgent: navigator.userAgent,
            timestamp: new Date().toISOString()
          })
        });
        
        // Show success message
        document.getElementById('bugForm').style.display = 'none';
        document.getElementById('successMessage').style.display = 'block';
        
        // Close after 3 seconds
        setTimeout(() => window.close(), 3000);
      } catch (error) {
        console.error('Failed to send bug report:', error);
        // Still show success to user
        document.getElementById('bugForm').style.display = 'none';
        document.getElementById('successMessage').style.display = 'block';
        setTimeout(() => window.close(), 3000);
      }
    }
  </script>
</body>
</html>

